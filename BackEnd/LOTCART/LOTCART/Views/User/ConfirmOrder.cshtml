@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LotKart - Confirm Order</title>
<style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }

        body {
            background: radial-gradient(circle, #06162f, #000814);
            color: white;
            min-height: 100vh;
        }

        /* Navbar */
        .navbar {
            background: #0a4a85;
            padding: 15px 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .search-box {
            position: relative;
        }

            .search-box input {
                padding: 8px 35px 8px 12px;
                border-radius: 20px;
                border: none;
                outline: none;
            }

        .search-icon {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        nav a {
            color: white;
            text-decoration: none;
            margin-left: 15px;
            font-size: 14px;
        }

        /* Main Container */
        .main {
            padding: 40px 60px;
            max-width: 1000px;
            margin: 0 auto;
        }

        /* Progress Section */
        .progress-container {
            margin-bottom: 40px;
        }

        .count {
            display: block;
            text-align: right;
            font-size: 22px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .progress-bar {
            width: 100%;
            height: 35px;
            background: #3d4450;
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid #555;
        }

        .progress-fill {
            height: 100%;
            background: #0a4a85;
            border-radius: 20px;
            transition: width 0.8s ease-in-out; /* This makes it move smoothly */
        }

        /* Info Text */
        .info {
            margin: 30px 0;
            font-size: 16px;
            line-height: 1.6;
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
        }

        .red {
            color: #ff4d6d;
            font-weight: bold;
        }

        /* Table Design */
        .table {
            margin-top: 40px;
            padding: 20px; /* This gives breathing room inside the table */
            background: rgba(255, 255, 255, 0.03); /* Optional: subtle box look */
            border-radius: 12px;
        }

        /* Also ensure the rows inside have consistent horizontal padding */
        .row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 10px; /* Padding for top/bottom and left/right */
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

            .row.head {
                font-size: 22px;
                font-weight: bold;
                border-bottom: 2px solid white;
            }

            .row small {
                display: block;
                font-size: 13px;
                opacity: 0.7;
                margin-top: 4px;
            }

        /* Quantity Controls */
        .qty {
            margin: 12px 0;
            display: inline-flex;
            align-items: center;
            background: #1a2a4a;
            border-radius: 8px;
            border: 1px solid #3a4a6a;
        }

            .qty button {
                background: none;
                color: white;
                border: none;
                font-size: 20px;
                padding: 5px 15px;
                cursor: pointer;
                transition: background 0.2s;
            }

                .qty button:hover {
                    background: #0a4a85;
                }

            .qty span {
                padding: 0 15px;
                font-weight: bold;
                min-width: 40px;
                text-align: center;
            }

        /* Total Section */
        .row.total {
            font-size: 26px;
            font-weight: bold;
            border-bottom: none;
            margin-top: 10px;
        }

        /* Checkout Button */
        .checkout {
            position: fixed;
            right: 40%;
            bottom: 30px;
            padding: 15px 50px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 40px;
            border: none;
            background: #0a4a85;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            transition: transform 0.2s, background 0.2s;
        }

            .checkout:hover {
                background: #0e5ca8;
                transform: scale(1.05);
            }

        .nav-balance {
            color: #4ade80; /* A nice green for money */
            font-weight: bold;
            font-size: 14px;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            display: flex;
            align-items: center;
        }

        /* Ensure the nav stays aligned */
        nav {
            display: flex;
            align-items: center;
            gap: 20px;
        }
</style>
</head>
<body>

    <header class="navbar">
        <div class="logo">LotKart</div>
        <nav>
            <a href="home.html">Home</a>
            <a href="log_in_worker.html">Worker</a>
            <a href="login_seller.html">Seller account</a>
            <a href="log_in.html">Log out</a>
            <a href="orders.html">Your orders</a>
            <div class="nav-balance">
                Balance: $<span id="userBalance">0.00</span>
            </div>
        </nav>
    </header>

    <div class="main">
        <div class="progress-container">
            <span class="count" id="displayProgressText">0/0</span>
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
            </div>
        </div>

        <p class="info">
            <b>Payment method:</b> Pay product price with confirmation payment.
            <span class="red">Cancellations lose the confirmation amount.</span>
        </p>

        <div class="table">
            <div class="row head">
                <span>Product</span>
                <span>Cost</span>
            </div>

            <div class="row">
                <span>
                    Leverage
                    <small>Returned after confirmation</small>
                </span>
                <span id="displayLeverage">$3</span>
            </div>

            <div class="row">
                <span>
                    <b id="displayProductName">Product Name</b>
                    <div class="qty">
                        <button onclick="changeQty(-1)">-</button>
                        <span id="qty">1</span>
                        <button onclick="changeQty(1)">+</button>
                    </div>
                </span>
                <span id="productCost">$0</span>
            </div>

            <div class="row total">
                <span>Total</span>
                <span id="total">$0</span>
            </div>
        </div>

        <button class="checkout" id="checkoutBtn">Checkout</button>
    </div>

    <script >
                // This data comes from your database
        const dbData = {
            orderid: 45,
            name: "keyboard",
            ordered: 100,
            quantity: 5,
            price: 75,
            vaid: 11
        };

        let currentQty = 1;

        function initPage() {
            document.getElementById("displayProgressText").innerText = `${dbData.ordered}/${dbData.quantity}`;
            const percentage = (dbData.ordered / dbData.quantity) * 100;
            document.getElementById("progressFill").style.width = percentage + "%";
            document.getElementById("displayProductName").innerText = dbData.name;
            updatePrice();
        }

        function changeQty(val) {
            currentQty += val;
            if (currentQty < 1) currentQty = 1;
            document.getElementById("qty").innerText = currentQty;
            updatePrice();
        }

        function updatePrice() {
            const productTotal = currentQty * dbData.price;
            const totalWithFees = productTotal + 3; // +3 for leverage/shipping

            document.getElementById("productCost").innerText = `$${productTotal}`;
            document.getElementById("total").innerText = `$${totalWithFees}`;
        }

        // --- NEW CHECKOUT LOGIC ---
        // --- UPDATED CHECKOUT LOGIC ---
        document.getElementById("checkoutBtn").addEventListener("click", function() {
            // 1. Get the final amount from the screen (stripping the '$')
            const totalAmount = parseFloat(document.getElementById("total").innerText.replace('$', ''));

            // 2. Generate random 6-digit verification key
            const vKey = Math.floor(100000 + Math.random() * 900000);

            // 3. Create the Database Object
            const orderObject = {
                productid: dbData.orderid,
                buyername: localStorage.getItem("currentUser") || "Guest", // Using the session we talked about
                buyeraddress: "User Address",
                verificationkey: vKey,
                vaid: dbData.vaid,
                amount: totalAmount,
                numbersofproduct: currentQty // <--- This is the value you selected
            };

            console.log("Checkout Object Created:", orderObject);
            alert(`Order Placed! Your Verification Key is: ${vKey}`);
        });
        initPage();
    </script>
</body>
</html>

